import{a as k}from"./axios-upsvKRUO.js";import{d as T,j as v,r as p,b as w,c as h,e as r,f as n,v as s,L as a,s as E,n as g,m as C,M as V,l as b,N as j,_ as D}from"./index-BzLU-hWo.js";const $={class:"shu-content"},A={class:"ai-features"},I={class:"ai-list"},M={key:1,class:"result-content"},G={class:"video-preview"},P=["src"],S={class:"action-buttons"},q="http://localhost:3000",z=T({__name:"index",setup(F){v("Content of the modal");const m=v(!1),c=v(!1),u=v(""),o=v(""),d=v(!1),x=async()=>{try{await navigator.clipboard.writeText(o.value),a.success("链接已复制到剪贴板")}catch(i){console.error("复制失败:",i),a.error("复制失败，请手动复制")}},U=()=>{m.value=!0,u.value="",o.value="",d.value=!1},L=async()=>{var i;if(!o.value){a.warning("没有可下载的视频");return}try{d.value=!0,a.loading("正在下载视频...",0);const e=await k({url:o.value,method:"GET",responseType:"blob",timeout:3e4}),t=new Blob([e.data],{type:e.headers["content-type"]||"video/mp4"}),f=window.URL.createObjectURL(t),y=((i=o.value.split("/").pop())==null?void 0:i.split("?")[0])||`video_${Date.now()}.mp4`,l=document.createElement("a");l.href=f,l.download=y,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(f),a.destroy(),a.success("下载成功！")}catch(e){console.error("下载视频失败:",e),a.destroy(),window.open(o.value,"_blank"),a.warning("直接下载失败，已在新窗口打开视频链接")}finally{d.value=!1}},B=async()=>{var i,e;if(!u.value){a.warning("请输入视频链接");return}d.value=!0,c.value=!0;try{const t=await k.post(`${q}/api/watermark-remove`,{url:u.value});t.data.success?(o.value=t.data.videoUrl,a.success("视频处理成功！"),c.value=!1):(a.error(t.data.message||"处理失败，请重试"),c.value=!1)}catch(t){console.error("处理视频时出错:",t),a.error(((e=(i=t.response)==null?void 0:i.data)==null?void 0:e.message)||"网络请求失败，请重试"),c.value=!1}finally{d.value=!1}},N=()=>{m.value=!1,u.value="",o.value="",d.value=!1,c.value=!1};return(i,e)=>{const t=p("a-input"),f=p("a-form-item"),y=p("a-spin"),l=p("a-button"),O=p("a-form"),R=p("a-modal");return w(),h("div",$,[r("div",A,[r("div",I,[r("div",{class:"ai-item",onClick:e[0]||(e[0]=_=>U())},"视频去水印")])]),r("div",null,[n(R,{open:m.value,"onUpdate:open":e[2]||(e[2]=_=>m.value=_),title:"视频去水印","confirm-loading":c.value,onOk:B,onCancel:N,width:800,footer:o.value?null:void 0},{default:s(()=>[n(O,{layout:"vertical"},{default:s(()=>[n(f,{label:"视频链接"},{default:s(()=>[n(t,{value:u.value,"onUpdate:value":e[1]||(e[1]=_=>u.value=_),placeholder:"请输入视频链接"},null,8,["value"])]),_:1}),d.value?(w(),E(f,{key:0},{default:s(()=>[n(y,{tip:"处理中..."},{default:s(()=>e[3]||(e[3]=[r("div",{class:"loading-content"},"正在处理视频，请稍候...",-1)])),_:1})]),_:1})):g("",!0),o.value?(w(),h("div",M,[e[7]||(e[7]=r("p",{class:"success-text"},"视频处理成功！",-1)),r("div",G,[r("video",{src:o.value,controls:"",style:{width:"100%","max-height":"400px"},preload:"metadata"}," 您的浏览器不支持视频播放 ",8,P)]),r("div",S,[n(l,{type:"primary",onClick:L,class:"download-btn"},{icon:s(()=>[n(C(V))]),default:s(()=>[e[4]||(e[4]=b(" 下载视频 "))]),_:1}),n(l,{type:"primary",onClick:x},{icon:s(()=>[n(C(j))]),default:s(()=>[e[5]||(e[5]=b(" 复制链接 "))]),_:1}),n(l,{type:"link",href:o.value,target:"_blank"},{default:s(()=>e[6]||(e[6]=[b(" 打开视频链接 ")])),_:1},8,["href"])])])):g("",!0)]),_:1})]),_:1},8,["open","confirm-loading","footer"])])])}}}),K=D(z,[["__scopeId","data-v-823957d5"]]);export{K as default};
